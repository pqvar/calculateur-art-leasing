<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Calculateur interactif de d√©fiscalisation par l'Art Leasing. Comparez l'optimisation fiscale entre dividendes et leasing d'≈ìuvres d'art, avec contr√¥le du taux de distribution." />
  <meta name="keywords" content="art leasing, d√©fiscalisation, optimisation fiscale, dividendes, ≈ìuvre d'art, IS, calculateur" />
  <meta name="author" content="Art Leasing Conseil" />
  <title>Calculateur Art Leasing - Optimisation Fiscale</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #333; padding: 20px; min-height: 100vh; }
    .container { max-width: 1400px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; }
    header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; text-align: center; }
    h1 { font-size: 2.2em; margin-bottom: 10px; }
    .subtitle { font-size: 1.05em; opacity: 0.95; }
    .controls { margin-top: 30px; }
    .controls > div { background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px; max-width: 1000px; margin: 0 auto; }
    .controls input { width: 100%; padding: 12px; font-size: 1.05em; border: 2px solid white; border-radius: 8px; font-weight: 600; }
    .controls label { display: block; margin-bottom: 8px; font-weight: 700; }
    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px; }
    .grid-6 { display: grid; grid-template-columns: repeat(6, 1fr); gap: 15px; }
    .info-box { margin-top: 10px; padding: 10px; background: rgba(255,255,255,0.3); border-radius: 8px; font-size: 0.92em; }
    .tabs { display: flex; background: #f8f9fa; border-bottom: 2px solid #e0e0e0; flex-wrap: wrap; }
    .tab { flex: 1; min-width: 150px; padding: 16px 10px; text-align: center; cursor: pointer; font-weight: 700; transition: all 0.3s; border-bottom: 3px solid transparent; font-size: 0.9em; }
    .tab:hover { background: #e9ecef; }
    .tab.active { background: white; border-bottom: 3px solid #667eea; color: #667eea; }
    .content { padding: 30px; }
    .tab-content { display: none; animation: fadeIn 0.5s; }
    .tab-content.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    .comparison-cards { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin: 30px 0; }
    .card { background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); padding: 24px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); transition: transform 0.3s; }
    .card:hover { transform: translateY(-5px); box-shadow: 0 15px 40px rgba(0,0,0,0.15); }
    .card.winner { background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); border: 3px solid #4CAF50; }
    .card h3 { color: #333; margin-bottom: 12px; font-size: 1.25em; }
    .big-number { font-size: 2.2em; font-weight: 800; color: #667eea; margin: 16px 0; }
    .card.winner .big-number { color: #2e7d32; }
    .stat-row { display: flex; justify-content: space-between; gap: 12px; padding: 10px 12px; margin: 8px 0; background: rgba(255,255,255,0.55); border-radius: 8px; }
    .stat-label { font-weight: 700; }
    .stat-value { font-weight: 800; color: #667eea; }
    .muted { color: #666; font-weight: 500; }
    .gain-badge { display: inline-block; background: #4CAF50; color: white; padding: 8px 14px; border-radius: 25px; font-weight: 800; margin: 14px 0; }
    .chart-container { position: relative; height: 380px; margin: 26px 0; }
    .flow-diagram { margin: 32px 0; }
    .flow-step { display: flex; align-items: center; margin: 16px 0; padding: 16px; background: #f8f9fa; border-radius: 10px; transition: all 0.3s; }
    .flow-step:hover { background: #e9ecef; transform: translateX(10px); }
    .flow-icon { width: 54px; height: 54px; background: #667eea; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.3em; font-weight: 900; margin-right: 16px; flex-shrink: 0; }
    .flow-content { flex: 1; }
    .flow-amount { font-size: 1.3em; font-weight: 900; color: #667eea; }
    .flow-amount.negative { color: #f44336; }
    .flow-amount.positive { color: #4CAF50; }
    .arrow { text-align: center; font-size: 1.6em; color: #667eea; margin: 8px 0; }
    .highlight-box { background: #fff3cd; border-left: 5px solid #ffc107; padding: 16px; margin: 18px 0; border-radius: 5px; }
    .summary-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin: 24px 0; }
    .summary-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; text-align: center; }
    .summary-card h4 { font-size: 0.86em; margin-bottom: 8px; opacity: 0.9; }
    .summary-card .value { font-size: 1.7em; font-weight: 900; }
    button.cta { background: #4CAF50; color: white; border: none; padding: 12px 24px; font-size: 1.05em; border-radius: 25px; cursor: pointer; transition: all 0.3s; margin: 14px 0; }
    button.cta:hover { background: #45a049; transform: scale(1.05); }
    button { background: white; color: #667eea; border: none; padding: 10px 16px; border-radius: 8px; cursor: pointer; font-weight: 800; transition: all 0.3s; }
    button:hover { background: #f0f0f0; }
    .warning-box { background: #ffebee; border-left: 5px solid #f44336; padding: 16px; margin: 18px 0; border-radius: 5px; }
    .success-box { background: #e8f5e9; border-left: 5px solid #4CAF50; padding: 16px; margin: 18px 0; border-radius: 5px; }
    .info-banner { background: #e3f2fd; border-left: 5px solid #2196F3; padding: 16px; margin: 18px 0; border-radius: 5px; }

    @media (max-width: 900px) {
      .comparison-cards, .summary-grid { grid-template-columns: 1fr; }
      .grid-2, .grid-6 { grid-template-columns: 1fr; }
      h1 { font-size: 1.6em; }
      .tab { font-size: 0.82em; padding: 14px 6px; }
    }

    @media print {
      body { background: white; padding: 0; }
      .container { box-shadow: none; border-radius: 0; }
      .controls, .tabs, button, .tab, input { display: none !important; }
      header { background: white !important; color: #333 !important; border-bottom: 3px solid #667eea; page-break-after: avoid; }
      h1 { color: #667eea !important; }
      .subtitle { color: #666 !important; }
      .tab-content { display: block !important; page-break-before: always; }
      .tab-content:first-child { page-break-before: avoid; }
      .card { border: 2px solid #ddd; box-shadow: none; page-break-inside: avoid; }
      .card.winner { border: 3px solid #4CAF50; }
      .summary-card { border: 2px solid #667eea; }
      .comparison-cards, .summary-grid, .highlight-box, .success-box, .info-banner, table { page-break-inside: avoid; }
      .chart-container { display: none !important; }
      table { border-collapse: collapse; width: 100%; }
      @page { margin: 2cm; }
    }
    @media screen { .tab-content { display: none; } .tab-content.active { display: block; } }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üé® D√©fiscalisation par l'Art Leasing</h1>
      <p class="subtitle">Analyse interactive ‚Äì ajoutez un taux de distribution (0% = tout en r√©serve, 100% = tout distribu√©)</p>

      <div class="controls">
        <div>
          <div class="grid-2">
            <div>
              <label>R√©sultat annuel de la soci√©t√© :</label>
              <input type="number" id="resultatAnnuel" step="1000" min="0" placeholder="Ex: 30000" oninput="updateCalculations()" />
            </div>
            <div>
              <label>Valeur de l'≈ìuvre √† la revente :</label>
              <input type="number" id="valeurOeuvre" step="1000" min="0" placeholder="Ex: 30000" oninput="updateCalculations()" />
            </div>
          </div>
          <div class="grid-6">
            <div>
              <label style="font-size: 0.9em;">Loyer mensuel (‚Ç¨) :</label>
              <input type="number" id="loyerMensuel" step="50" min="0" placeholder="Ex: 1600" oninput="updateCalculations()" />
            </div>
            <div>
              <label style="font-size: 0.9em;">Dur√©e (mois) :</label>
              <input type="number" id="dureeMois" value="24" step="1" min="12" max="60" oninput="updateCalculations()" />
            </div>
            <div>
              <label style="font-size: 0.9em;">Apport initial (‚Ç¨) :</label>
              <input type="number" id="apportInitial" value="0" step="500" min="0" oninput="updateCalculations()" />
            </div>
            <div>
              <label style="font-size: 0.9em;">Taux IS (%) :</label>
              <input type="number" id="tauxIS" value="25" step="0.1" min="0" max="100" oninput="updateCalculations()" />
            </div>
            <div>
              <label style="font-size: 0.9em;">Taxe dividendes (%) :</label>
              <input type="number" id="tauxDividendes" value="30" step="0.1" min="0" max="100" oninput="updateCalculations()" />
            </div>
            <div>
              <label style="font-size: 0.9em;">Taux de distribution : <strong><span id="tauxDistributionValue">100%</span></strong></label>
              <input type="range" id="tauxDistribution" value="100" step="1" min="0" max="100"
                     oninput="document.getElementById('tauxDistributionValue').textContent = this.value + '%'; updateCalculations()" />
            </div>
          </div>
          <div class="info-box">
            üí° <strong>Distribution :</strong> 0% = tout reste en r√©serve (pas de flat tax), 100% = tout est distribu√©.<br/>
            <span id="chargesInfo" style="font-weight: bold; color: #2e7d32;"></span>
          </div>
          <button onclick="resetDefaults()">üîÑ R√©initialiser aux valeurs par d√©faut</button>
          <button onclick="downloadPDF()" style="background: #4CAF50; color: white; margin-left: 10px;">üì• T√©l√©charger le rapport PDF</button>
        </div>
      </div>
    </header>

    <div class="tabs">
      <div class="tab active" onclick="showTab(0)">üìä Vue Globale</div>
      <div class="tab" onclick="showTab(1)">üéØ R√©sultat N√©cessaire</div>
      <div class="tab" onclick="showTab(2)">üí∞ R√©sultat Identique</div>
      <div class="tab" onclick="showTab(3)">üé® Art Leasing</div>
      <div class="tab" onclick="showTab(4)">üíº Dividendes</div>
      <div class="tab" onclick="showTab(5)">üìà Graphiques</div>
    </div>

    <div class="content">
      <!-- TAB 0: Vue Globale -->
      <div class="tab-content active">
        <h2 style="text-align: center; margin-bottom: 20px;">üîç Analyse ‚Äì Deux angles</h2>

        <div class="info-banner">
          <h3>üìå Deux visions compl√©mentaires</h3>
          <p class="muted">
            <strong>1Ô∏è‚É£ M√™me objectif net :</strong> Quel r√©sultat faut-il pour obtenir le m√™me net dans la poche ?<br />
            <strong>2Ô∏è‚É£ M√™me r√©sultat de d√©part :</strong> Avec le m√™me r√©sultat, qui met le plus dans la poche (en tenant compte du taux de distribution) ?
          </p>
        </div>

        <h3 style="text-align: center; margin: 24px 0 12px 0;">1Ô∏è‚É£ R√âSULTAT N√âCESSAIRE</h3>
        <p style="text-align: center; color: #666; margin-bottom: 10px;">
          Objectif net √† √©galer : <span id="vue1_objectif" style="color: #4CAF50; font-weight: 900;">‚Äî</span><br/>
          <span class="muted" id="vue1_note"></span>
        </p>
        <div class="comparison-cards">
          <div class="card winner">
            <h3>üé® Art Leasing</h3>
            <div class="big-number" id="vue1_resultatAL">‚Äî</div>
            <div class="stat-row"><span class="stat-label">Net dans la poche</span><span class="stat-value" id="vue1_netAL">‚Äî</span></div>
          </div>
          <div class="card">
            <h3>üí∞ Dividendes</h3>
            <div class="big-number" id="vue1_resultatDiv">‚Äî</div>
            <div class="stat-row"><span class="stat-label">Net dans la poche</span><span class="stat-value" id="vue1_netDiv">‚Äî</span></div>
          </div>
        </div>
        <div class="success-box">
          <p style="text-align:center;"><strong>√âconomie de r√©sultat : <span id="vue1_economie">‚Äî</span> (<span id="vue1_pourcent">‚Äî</span>)</strong></p>
          <p class="muted" id="vue1_warning"></p>
        </div>

        <hr style="margin: 30px 0; border: none; border-top: 2px dashed #ccc;" />

        <h3 style="text-align: center; margin: 24px 0 12px 0;">2Ô∏è‚É£ R√âSULTAT IDENTIQUE</h3>
        <p style="text-align: center; color: #666; margin-bottom: 10px;">
          R√©sultat de d√©part (2 ans) : <span id="vue2_resultat" style="color: #667eea; font-weight: 900;">‚Äî</span>
        </p>
        <div class="comparison-cards">
          <div class="card winner">
            <h3>üé® Art Leasing</h3>
            <div class="big-number" id="vue2_netAL">‚Äî</div>
            <div class="stat-row"><span class="stat-label">Dividendes nets (distribu√©s)</span><span class="stat-value" id="vue2_divNetsAL">‚Äî</span></div>
            <div class="stat-row"><span class="stat-label">R√©serves conserv√©es</span><span class="stat-value" id="vue2_reservesAL">‚Äî</span></div>
          </div>
          <div class="card">
            <h3>üí∞ Dividendes</h3>
            <div class="big-number" id="vue2_netDiv">‚Äî</div>
            <div class="stat-row"><span class="stat-label">Dividendes nets (distribu√©s)</span><span class="stat-value" id="vue2_divNetsDiv">‚Äî</span></div>
            <div class="stat-row"><span class="stat-label">R√©serves conserv√©es</span><span class="stat-value" id="vue2_reservesDiv">‚Äî</span></div>
          </div>
        </div>
        <div class="success-box">
          <p style="text-align:center;"><strong>Gain net suppl√©mentaire : <span id="vue2_gain">‚Äî</span> (<span id="vue2_pourcent">‚Äî</span>)</strong></p>
        </div>

        <div class="highlight-box" style="margin-top: 20px;">
          <h3>üéØ Synth√®se</h3>
          <table style="width: 100%; margin-top: 10px; border-collapse: collapse;">
            <tr style="background: #f5f5f5;">
              <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">Angle</th>
              <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">Art Leasing</th>
              <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">Dividendes</th>
              <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">Avantage</th>
            </tr>
            <tr>
              <td style="padding: 10px; border: 1px solid #ddd;"><strong>R√©sultat pour objectif net</strong></td>
              <td style="padding: 10px; text-align: center; border: 1px solid #ddd; background: #e8f5e9;" id="synth_res1AL"><strong>‚Äî</strong></td>
              <td style="padding: 10px; text-align: center; border: 1px solid #ddd;" id="synth_res1Div">‚Äî</td>
              <td style="padding: 10px; text-align: center; border: 1px solid #ddd; color: #4CAF50;" id="synth_eco1"><strong>‚Äî</strong></td>
            </tr>
            <tr>
              <td style="padding: 10px; border: 1px solid #ddd;"><strong>Net obtenu (m√™me r√©sultat)</strong></td>
              <td style="padding: 10px; text-align: center; border: 1px solid #ddd; background: #e8f5e9;" id="synth_net2AL"><strong>‚Äî</strong></td>
              <td style="padding: 10px; text-align: center; border: 1px solid #ddd;" id="synth_net2Div">‚Äî</td>
              <td style="padding: 10px; text-align: center; border: 1px solid #ddd; color: #4CAF50;" id="synth_gain2"><strong>‚Äî</strong></td>
            </tr>
          </table>
        </div>
      </div>

      <!-- TAB 1: R√©sultat N√©cessaire -->
      <div class="tab-content">
        <h2 style="text-align: center; margin-bottom: 16px;">üéØ Comparaison 1 : R√©sultat N√©cessaire</h2>
        <p style="text-align: center; color: #666; font-size: 1.05em; margin-bottom: 16px;">
          Objectif net √† √©galer : <strong><span id="rn_objectif" style="color: #4CAF50;">‚Äî</span></strong>
          <span class="muted" id="rn_note"></span>
        </p>
        <div class="comparison-cards">
          <div class="card winner">
            <h3>üé® Art Leasing</h3>
            <div class="big-number" id="rn_resultatAL">‚Äî</div>
            <div class="stat-row"><span class="stat-label">Charges d√©ductibles</span><span class="stat-value" id="rn_chargesAL">‚Äî</span></div>
            <div class="stat-row"><span class="stat-label">Imp√¥ts totaux</span><span class="stat-value" id="rn_impotsAL">‚Äî</span></div>
            <div class="stat-row"><span class="stat-label">Div. nets / R√©serves</span><span class="stat-value" id="rn_divResAL">‚Äî</span></div>
            <div class="stat-row"><span class="stat-label">Net final (div. + revente)</span><span class="stat-value" id="rn_netAL">‚Äî</span></div>
          </div>
          <div class="card">
            <h3>üí∞ Dividendes</h3>
            <div class="big-number" id="rn_resultatDiv">‚Äî</div>
            <div class="stat-row"><span class="stat-label">Imp√¥ts totaux</span><span class="stat-value" id="rn_impotsDiv">‚Äî</span></div>
            <div class="stat-row"><span class="stat-label">Div. nets / R√©serves</span><span class="stat-value" id="rn_divResDiv">‚Äî</span></div>
            <div class="stat-row"><span class="stat-label">Net final</span><span class="stat-value" id="rn_netDiv">‚Äî</span></div>
          </div>
        </div>
        <div class="summary-grid">
          <div class="summary-card"><h4>√âCONOMIE DE R√âSULTAT</h4><div class="value" id="rn_economieResultat">‚Äî</div></div>
          <div class="summary-card"><h4>√âCONOMIE D'IMP√îTS</h4><div class="value" id="rn_economieImpots">‚Äî</div></div>
          <div class="summary-card"><h4>EFFICACIT√â</h4><div class="value" id="rn_efficacite">‚Äî</div></div>
        </div>
      </div>

      <!-- TAB 2: R√©sultat Identique -->
      <div class="tab-content">
        <h2 style="text-align: center; margin-bottom: 16px;">üí∞ Comparaison 2 : R√©sultat Identique</h2>
        <p style="text-align: center; color: #666; margin-bottom: 10px;">Avec <strong><span id="ri_resultat" style="color: #667eea;">‚Äî</span></strong> de r√©sultat (2 ans)</p>
        <div class="comparison-cards">
          <div class="card winner">
            <h3>üé® Art Leasing</h3>
            <div class="big-number" id="ri_netAL">‚Äî</div>
            <div class="stat-row"><span class="stat-label">Dividendes nets (distribu√©s)</span><span class="stat-value" id="ri_divNetsAL">‚Äî</span></div>
            <div class="stat-row"><span class="stat-label">R√©serves conserv√©es</span><span class="stat-value" id="ri_reservesAL">‚Äî</span></div>
          </div>
          <div class="card">
            <h3>üí∞ Dividendes</h3>
            <div class="big-number" id="ri_netDiv">‚Äî</div>
            <div class="stat-row"><span class="stat-label">Dividendes nets (distribu√©s)</span><span class="stat-value" id="ri_divNetsDiv">‚Äî</span></div>
            <div class="stat-row"><span class="stat-label">R√©serves conserv√©es</span><span class="stat-value" id="ri_reservesDiv">‚Äî</span></div>
          </div>
        </div>
        <div class="summary-grid">
          <div class="summary-card"><h4>GAIN NET</h4><div class="value" id="ri_gainNet">‚Äî</div></div>
          <div class="summary-card"><h4>√âCONOMIE D'IMP√îTS</h4><div class="value" id="ri_economieImpots">‚Äî</div></div>
          <div class="summary-card"><h4>GAIN EN %</h4><div class="value" id="ri_gainPourcent">‚Äî</div></div>
        </div>
      </div>

      <!-- TAB 3: Art Leasing -->
      <div class="tab-content">
        <h2 style="text-align: center; margin-bottom: 16px;">üé® Sc√©nario Art Leasing D√©taill√©</h2>
        <div class="flow-diagram">
          <div class="flow-step">
            <div class="flow-icon">1</div>
            <div class="flow-content"><h4>R√©sultat de la soci√©t√© (2 ans)</h4><div class="flow-amount positive" id="al_resultat">‚Äî</div></div>
          </div>
          <div class="arrow">‚Üì</div>
          <div class="flow-step" style="background: #e8f5e9;">
            <div class="flow-icon" style="background: #4CAF50;">üí°</div>
            <div class="flow-content">
              <h4 id="al_chargesTitle">Charges de leasing - D√âDUCTIBLES</h4>
              <div class="flow-amount negative" id="al_charges">‚Äî</div>
              <p style="color: #2e7d32; margin-top: 5px; font-weight: bold;" id="al_chargesDetail">‚úì D√©duction fiscale majeure !</p>
              <p style="color: #666; margin-top: 5px;" id="al_resultatImposable">R√©sultat imposable : ‚Äî</p>
            </div>
          </div>
          <div class="arrow">‚Üì</div>
          <div class="flow-step">
            <div class="flow-icon">2</div>
            <div class="flow-content"><h4>Imp√¥t sur les Soci√©t√©s (IS)</h4><div class="flow-amount negative" id="al_is">‚Äî</div><p style="color: #666; margin-top: 5px;" id="al_resultatNet">R√©sultat net : ‚Äî</p></div>
          </div>
          <div class="arrow">‚Üì</div>
          <div class="flow-step">
            <div class="flow-icon">3</div>
            <div class="flow-content"><h4>Distribution (taux param√©trable)</h4><div class="flow-amount negative" id="al_taxeDividendes">‚Äî</div><p style="color: #666; margin-top: 5px;" id="al_dividendesNets">Dividendes nets : ‚Äî</p><p class="muted" id="al_reserves">R√©serves : ‚Äî</p></div>
          </div>
          <div class="arrow">‚Üì</div>
          <div class="flow-step" style="background: #fff3cd; border: 2px solid #ffc107;">
            <div class="flow-icon" style="background: #ffc107;">üé®</div>
            <div class="flow-content">
              <h4>FIN DE CONTRAT ‚Äì Rachat & revente</h4>
              <div style="margin: 10px 0;" id="al_reventeDetail"></div>
            </div>
          </div>
          <div class="arrow">‚Üì</div>
          <div class="flow-step" style="background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); border: 3px solid #4CAF50;">
            <div class="flow-icon" style="background: #4CAF50;">‚úì</div>
            <div class="flow-content"><h4>NET TOTAL DANS LA POCHE</h4><div class="flow-amount positive" style="font-size: 1.6em;" id="al_netTotal">‚Äî</div><p style="color: #666; margin-top: 5px;" id="al_netDetail">‚Äî</p><p style="color: #2e7d32; margin-top: 8px; font-weight: bold;" id="al_tauxPonction">Taux de ponction global : ‚Äî</p></div>
          </div>
        </div>
      </div>

      <!-- TAB 4: Dividendes -->
      <div class="tab-content">
        <h2 style="text-align: center; margin-bottom: 16px;">üíº Sc√©nario Dividendes</h2>
        <div class="flow-diagram">
          <div class="flow-step" style="background: #ffebee; border: 2px solid #f44336;">
            <div class="flow-icon" style="background: #f44336;">?</div>
            <div class="flow-content"><h4>R√©sultat n√©cessaire (pour objectif net)</h4><div class="flow-amount" style="font-size: 1.4em;" id="div_resultatNecessaire">‚Äî</div><p class="muted" id="div_note">‚Äî</p></div>
          </div>
          <div class="arrow">‚Üì</div>
          <div class="flow-step">
            <div class="flow-icon">1</div>
            <div class="flow-content"><h4>IS</h4><div class="flow-amount negative" id="div_is">‚Äî</div><p style="color: #666; margin-top: 5px;" id="div_resultatNet">R√©sultat net : ‚Äî</p></div>
          </div>
          <div class="arrow">‚Üì</div>
          <div class="flow-step">
            <div class="flow-icon">2</div>
            <div class="flow-content"><h4>Distribution (taux param√©trable)</h4><div class="flow-amount negative" id="div_taxeDividendes">‚Äî</div><p style="color: #666; margin-top: 5px;" id="div_dividendesNets">Dividendes nets : ‚Äî</p><p class="muted" id="div_reserves">R√©serves : ‚Äî</p></div>
          </div>
          <div class="arrow">‚Üì</div>
          <div class="flow-step" style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border: 3px solid #667eea;">
            <div class="flow-icon" style="background: #667eea;">‚úì</div>
            <div class="flow-content"><h4>NET DANS LA POCHE</h4><div class="flow-amount" style="font-size: 1.4em;" id="div_netFinal">‚Äî</div><p style="color: #666; margin-top: 5px;" id="div_tauxPonction">Taux de ponction : ‚Äî</p></div>
          </div>
        </div>
      </div>

      <!-- TAB 5: Graphiques -->
      <div class="tab-content">
        <h2 style="text-align: center; margin-bottom: 16px;">üìà Analyses Graphiques</h2>
        <div class="chart-container"><canvas id="resultatChart"></canvas></div>
        <div class="chart-container"><canvas id="netChart"></canvas></div>
        <div class="chart-container"><canvas id="efficaciteChart"></canvas></div>
        <div class="chart-container"><canvas id="coutChart"></canvas></div>
      </div>
    </div>
  </div>

  <script>
    function setText(id, value) { const el = document.getElementById(id); if (el) el.textContent = value; }
    function setHTML(id, value) { const el = document.getElementById(id); if (el) el.innerHTML = value; }
    function fmtEUR(value, maxFrac = 0) { return new Intl.NumberFormat('fr-FR', { style: 'currency', currency: 'EUR', maximumFractionDigits: maxFrac }).format(value); }
    function clamp(x, min, max){ return Math.min(max, Math.max(min, x)); }

    let calculations = {};

    function updateCalculations() {
      const resultatAnnuel = parseFloat(document.getElementById('resultatAnnuel').value) || 30000;
      const valeurOeuvre = parseFloat(document.getElementById('valeurOeuvre').value) || 30000;
      const tauxIS = (parseFloat(document.getElementById('tauxIS').value) || 25) / 100;
      const tauxDividendes = (parseFloat(document.getElementById('tauxDividendes').value) || 30) / 100;
      const tauxDistribution = clamp((parseFloat(document.getElementById('tauxDistribution').value) || 100) / 100, 0, 1);
      const dureeMois = parseInt(document.getElementById('dureeMois').value) || 24;
      const apportInitial = parseFloat(document.getElementById('apportInitial').value) || 0;
      const loyerMensuel = parseFloat(document.getElementById('loyerMensuel').value) || 1600;

      const resultatTotal = Math.max(0, resultatAnnuel * 2);
      const loyersTotal = Math.max(0, loyerMensuel * dureeMois);
      const chargesLeasingTotal = Math.max(0, loyersTotal + apportInitial);

      // ART LEASING
      const art_resultatImposable = resultatTotal - chargesLeasingTotal;
      const baseIS = Math.max(0, art_resultatImposable);
      const art_is = Math.round(baseIS * tauxIS);
      const art_resultatNet = art_resultatImposable - art_is;

      const art_divBruts = Math.max(0, art_resultatNet * tauxDistribution);
      const art_taxeDividendes = Math.round(art_divBruts * tauxDividendes);
      const art_dividendesNets = art_divBruts - art_taxeDividendes;
      const art_reserves = Math.max(0, art_resultatNet - art_divBruts);

      const art_rachat = Math.round(valeurOeuvre * 0.05);
      const art_revente = valeurOeuvre;
      const art_plusValue = Math.max(0, art_revente - art_rachat);
      const art_taxePlusValue = Math.round(art_plusValue * 0.065);
      const art_produitRevente = art_revente - art_rachat - art_taxePlusValue;

      const art_netTotal = Math.max(0, art_dividendesNets + art_produitRevente);
      const art_totalImpots = art_is + art_taxeDividendes + art_taxePlusValue;
      const art_tauxPonction = (resultatTotal>0) ? ((art_totalImpots / resultatTotal) * 100).toFixed(1) : '‚Äî';

      // COMPARAISON 1: R√©sultat n√©cessaire (dividendes) pour atteindre art_netTotal
      let div_resultatNecessaire = null, div_is=null, div_resultatNet = null, div_divBruts=null, div_taxeDividendes=null, div_netPoche=null, div_totalImpots=null, div_tauxPonction='‚Äî';
      if (tauxDistribution > 0) {
        div_resultatNecessaire = Math.round(art_netTotal / ((1 - tauxIS) * (1 - tauxDividendes) * tauxDistribution));
        div_is = Math.round(div_resultatNecessaire * tauxIS);
        div_resultatNet = div_resultatNecessaire - div_is;
        div_divBruts = Math.round(div_resultatNet * tauxDistribution);
        div_taxeDividendes = Math.round(div_divBruts * tauxDividendes);
        div_netPoche = div_divBruts - div_taxeDividendes;
        div_totalImpots = div_is + div_taxeDividendes;
        div_tauxPonction = ((div_totalImpots / div_resultatNecessaire) * 100).toFixed(1);
      }

      const economieResultat = (div_resultatNecessaire !== null) ? (div_resultatNecessaire - resultatTotal) : null;
      const pourcentageEconomie = (div_resultatNecessaire !== null && div_resultatNecessaire>0) ? ((economieResultat / div_resultatNecessaire) * 100).toFixed(1) : '‚Äî';
      const economieImpots = (div_resultatNecessaire !== null) ? ((div_is + div_taxeDividendes) - art_totalImpots) : null;

      // COMPARAISON 2: M√™me r√©sultat (dividendes classiques)
      const div2_is = Math.round(resultatTotal * tauxIS);
      const div2_resultatNet = resultatTotal - div2_is;
      const div2_divBruts = Math.round(div2_resultatNet * tauxDistribution);
      const div2_taxeDividendes = Math.round(div2_divBruts * tauxDividendes);
      const div2_netPoche = div2_divBruts - div2_taxeDividendes;
      const div2_reserves = Math.max(0, div2_resultatNet - div2_divBruts);
      const div2_totalImpots = div2_is + div2_taxeDividendes;

      const gainNet = art_netTotal - div2_netPoche;
      const gainPourcent = (div2_netPoche>0) ? ((gainNet / div2_netPoche) * 100).toFixed(1) : '‚Äî';
      const economieImpots2 = div2_totalImpots - art_totalImpots;

      // EXTRACTION DE VALEUR (pour info graphiques)
      const valeur_extraite = art_produitRevente;
      const surcout_financement = (loyersTotal + apportInitial) - valeurOeuvre;
      const extract2_coutAL = Math.max(0, surcout_financement) + art_rachat + art_taxePlusValue;
      const extract2_ratioAL = (valeur_extraite>0) ? ((extract2_coutAL / valeur_extraite) * 100).toFixed(1) : '‚Äî';

      let extract2_resultatDiv = null, extract2_isDiv=null, extract2_resultatNetDiv=null, extract2_flatTaxDiv=null, extract2_coutDiv=null, extract2_ratioDiv='‚Äî';
      if (tauxDistribution > 0) {
        extract2_resultatDiv = Math.round(valeur_extraite / ((1 - tauxIS) * (1 - tauxDividendes) * tauxDistribution));
        extract2_isDiv = Math.round(extract2_resultatDiv * tauxIS);
        extract2_resultatNetDiv = extract2_resultatDiv - extract2_isDiv;
        const extract2_divBruts = Math.round(extract2_resultatNetDiv * tauxDistribution);
        extract2_flatTaxDiv = Math.round(extract2_divBruts * tauxDividendes);
        extract2_coutDiv = extract2_isDiv + extract2_flatTaxDiv;
        extract2_ratioDiv = (valeur_extraite>0) ? ((extract2_coutDiv / valeur_extraite) * 100).toFixed(1) : '‚Äî';
      }

      const extract2_fois = (tauxDistribution>0 && extract2_ratioAL!=='‚Äî' && extract2_ratioDiv!=='‚Äî') ? (parseFloat(extract2_ratioDiv) / parseFloat(extract2_ratioAL)).toFixed(1) : '‚Äî';
      const extract2_economieParEuro = (tauxDistribution>0 && extract2_ratioAL!=='‚Äî' && extract2_ratioDiv!=='‚Äî') ? (((parseFloat(extract2_ratioDiv) - parseFloat(extract2_ratioAL)) / 100)).toFixed(2) : '‚Äî';

      calculations = {
        resultatTotal, loyerMensuel, loyersTotal, apportInitial, chargesLeasingTotal,
        tauxIS, tauxDividendes, tauxDistribution, valeurOeuvre, dureeMois,

        art_resultatImposable, art_is, art_resultatNet, art_divBruts, art_taxeDividendes, art_dividendesNets,
        art_reserves, art_rachat, art_revente, art_taxePlusValue, art_produitRevente,
        art_netTotal, art_totalImpots, art_tauxPonction,

        div_resultatNecessaire, div_is, div_resultatNet, div_divBruts, div_taxeDividendes, div_netPoche, div_totalImpots, div_tauxPonction,
        div2_is, div2_resultatNet, div2_divBruts, div2_taxeDividendes, div2_netPoche, div2_reserves, div2_totalImpots,

        economieResultat, pourcentageEconomie, economieImpots, gainNet, gainPourcent, economieImpots2,

        valeur_extraite, surcout_financement, extract2_coutAL, extract2_ratioAL, extract2_resultatDiv, extract2_isDiv, extract2_resultatNetDiv, extract2_flatTaxDiv, extract2_coutDiv, extract2_ratioDiv, extract2_fois, extract2_economieParEuro,

        extract_AL_coutTotal: extract2_coutAL,
        extract_div_coutTotal: (extract2_coutDiv===null?0:extract2_coutDiv),
        extract_div_resultatNecessaire: (extract2_resultatDiv===null?0:extract2_resultatDiv)
      };

      updateDisplay();
    }

    function updateDisplay(){
      const c = calculations;

      const info = `Charges leasing : ${fmtEUR(c.loyersTotal)}${c.apportInitial>0?(' + Apport '+fmtEUR(c.apportInitial)):""} ‚Ä¢ Taux de distribution : ${(c.tauxDistribution*100).toFixed(0)}%`;
      setText('chargesInfo', info);
      setText('tauxDistributionValue', `${(c.tauxDistribution*100).toFixed(0)}%`);
      const slider = document.getElementById('tauxDistribution');
      if (slider) slider.value = (c.tauxDistribution*100).toFixed(0);

      // Vue 1
      setText('vue1_objectif', fmtEUR(c.art_netTotal));
      setText('vue1_resultatAL', fmtEUR(c.resultatTotal));
      setText('vue1_netAL', fmtEUR(c.art_netTotal));

      if (c.div_resultatNecessaire !== null){
        setText('vue1_resultatDiv', fmtEUR(c.div_resultatNecessaire));
        setText('vue1_netDiv', fmtEUR(c.div_netPoche));
        setText('vue1_economie', fmtEUR(c.div_resultatNecessaire - c.resultatTotal));
        setText('vue1_pourcent', `-${c.pourcentageEconomie}%`);
        setText('vue1_note', `(Distribution ${ (c.tauxDistribution*100).toFixed(0) }% prise en compte)`);
        setText('vue1_warning', '');
      } else {
        setText('vue1_resultatDiv', '‚Äî');
        setText('vue1_netDiv', '‚Äî');
        setText('vue1_economie', '‚Äî');
        setText('vue1_pourcent', '‚Äî');
        setText('vue1_note', `(Distribution 0% : pas de versement, objectif inatteignable en dividendes)`);
        setText('vue1_warning', '‚ö†Ô∏è Avec 0% de distribution, il est impossible d‚Äôobtenir un net en poches via dividendes. Augmentez le taux de distribution.');
      }

      // Vue 2
      setText('vue2_resultat', fmtEUR(c.resultatTotal));
      setText('vue2_netAL', fmtEUR(c.art_netTotal));
      setText('vue2_divNetsAL', fmtEUR(c.art_dividendesNets));
      setText('vue2_reservesAL', fmtEUR(c.art_reserves));
      setText('vue2_netDiv', fmtEUR(c.div2_netPoche));
      setText('vue2_divNetsDiv', fmtEUR(c.div2_netPoche));
      setText('vue2_reservesDiv', fmtEUR(c.div2_reserves));
      setText('vue2_gain', fmtEUR(c.art_netTotal - c.div2_netPoche));
      setText('vue2_pourcent', (c.gainPourcent==='‚Äî')? '‚Äî' : `+${c.gainPourcent}%`);

      // Synth√®se
      setText('synth_res1AL', fmtEUR(c.resultatTotal));
      setText('synth_res1Div', (c.div_resultatNecessaire!==null)? fmtEUR(c.div_resultatNecessaire) : '‚Äî');
      setText('synth_eco1', (c.div_resultatNecessaire!==null)? fmtEUR(c.resultatTotal - c.div_resultatNecessaire) : '‚Äî');
      setText('synth_net2AL', fmtEUR(c.art_netTotal));
      setText('synth_net2Div', fmtEUR(c.div2_netPoche));
      setText('synth_gain2', fmtEUR(c.art_netTotal - c.div2_netPoche));

      // RN
      setText('rn_objectif', fmtEUR(c.art_netTotal));
      setText('rn_resultatAL', fmtEUR(c.resultatTotal));
      setText('rn_chargesAL', fmtEUR(-c.chargesLeasingTotal));
      setText('rn_impotsAL', fmtEUR(-c.art_totalImpots));
      setText('rn_divResAL', `${fmtEUR(c.art_dividendesNets)} / ${fmtEUR(c.art_reserves)}`);
      setText('rn_netAL', fmtEUR(c.art_netTotal));
      if (c.div_resultatNecessaire!==null) {
        setText('rn_resultatDiv', fmtEUR(c.div_resultatNecessaire));
        setText('rn_impotsDiv', fmtEUR(-(c.div_is + c.div_taxeDividendes)));
        setText('rn_divResDiv', `${fmtEUR(c.div_netPoche)} / ${fmtEUR(c.div_resultatNet - c.div_divBruts)}`);
        setText('rn_netDiv', fmtEUR(c.div_netPoche));
        setText('rn_economieResultat', fmtEUR(c.div_resultatNecessaire - c.resultatTotal));
        setText('rn_economieImpots', fmtEUR((c.div_is + c.div_taxeDividendes) - c.art_totalImpots));
        setText('rn_efficacite', `-${c.pourcentageEconomie}%`);
        setText('rn_note', `(Distribution ${(c.tauxDistribution*100).toFixed(0)}%)`);
      } else {
        setText('rn_resultatDiv', '‚Äî');
        setText('rn_impotsDiv', '‚Äî');
        setText('rn_divResDiv', '‚Äî');
        setText('rn_netDiv', '‚Äî');
        setText('rn_economieResultat', '‚Äî');
        setText('rn_economieImpots', '‚Äî');
        setText('rn_efficacite', '‚Äî');
        setText('rn_note', `(Distribution 0% : objectif inatteignable en dividendes)`);
      }

      // RI
      setText('ri_resultat', fmtEUR(c.resultatTotal));
      setText('ri_netAL', fmtEUR(c.art_netTotal));
      setText('ri_divNetsAL', fmtEUR(c.art_dividendesNets));
      setText('ri_reservesAL', fmtEUR(c.art_reserves));
      setText('ri_netDiv', fmtEUR(c.div2_netPoche));
      setText('ri_divNetsDiv', fmtEUR(c.div2_netPoche));
      setText('ri_reservesDiv', fmtEUR(c.div2_reserves));
      setText('ri_gainNet', fmtEUR(c.art_netTotal - c.div2_netPoche));
      setText('ri_economieImpots', fmtEUR(c.div2_totalImpots - c.art_totalImpots));
      setText('ri_gainPourcent', (c.gainPourcent==='‚Äî')? '‚Äî' : `+${c.gainPourcent}%`);

      // Art Leasing tab
      setText('al_resultat', fmtEUR(c.resultatTotal));
      setText('al_charges', fmtEUR(-c.chargesLeasingTotal));
      setText('al_resultatImposable', `R√©sultat imposable : ${fmtEUR(c.art_resultatImposable)}`);
      setText('al_is', fmtEUR(-c.art_is));
      setText('al_resultatNet', `R√©sultat net : ${fmtEUR(c.art_resultatNet)}`);
      setText('al_taxeDividendes', `Taxe sur distribution : ${fmtEUR(-c.art_taxeDividendes)}`);
      setText('al_dividendesNets', `Dividendes nets : ${fmtEUR(c.art_dividendesNets)}`);
      setText('al_reserves', `R√©serves conserv√©es : ${fmtEUR(c.art_reserves)}`);
      setHTML('al_reventeDetail', `
        <div><strong>Rachat (5%) :</strong> <span style="color:#f44336;font-weight:800;">${fmtEUR(-c.art_rachat)}</span></div>
        <div><strong>Revente :</strong> <span style="color:#4CAF50;font-weight:800;">${fmtEUR(c.art_revente)}</span></div>
        <div><strong>Taxe plus-value (6,5%) :</strong> <span style="color:#f44336;font-weight:800;">${fmtEUR(-c.art_taxePlusValue)}</span></div>
        <div style="margin-top:8px;padding-top:8px;border-top:2px solid #333;"><strong>Produit net :</strong> <span style="color:#4CAF50;font-weight:900;font-size:1.05em;">${fmtEUR(c.art_produitRevente)}</span></div>
      `);
      setText('al_netTotal', fmtEUR(c.art_netTotal));
      setText('al_netDetail', `${fmtEUR(c.art_dividendesNets)} (div.) + ${fmtEUR(c.art_produitRevente)} (revente)`);
      setText('al_tauxPonction', `Taux de ponction global : ${c.art_tauxPonction}%`);

      // Dividendes tab
      if (c.div_resultatNecessaire!==null){
        setText('div_resultatNecessaire', fmtEUR(c.div_resultatNecessaire));
        setText('div_note', `Objectif = net Art Leasing. Distribution ${(c.tauxDistribution*100).toFixed(0)}%.`);
        setText('div_is', fmtEUR(-c.div_is));
        setText('div_resultatNet', `R√©sultat net : ${fmtEUR(c.div_resultatNet)}`);
        setText('div_taxeDividendes', fmtEUR(-c.div_taxeDividendes));
        setText('div_dividendesNets', `Dividendes nets : ${fmtEUR(c.div_netPoche)}`);
        setText('div_reserves', `R√©serves : ${fmtEUR(c.div_resultatNet - c.div_divBruts)}`);
        setText('div_netFinal', fmtEUR(c.div_netPoche));
        setText('div_tauxPonction', `Taux de ponction : ${c.div_tauxPonction}%`);
      } else {
        setText('div_resultatNecessaire', '‚Äî');
        setText('div_note', 'Distribution 0% : objectif net inatteignable via dividendes.');
        setText('div_is', '‚Äî');
        setText('div_resultatNet', '‚Äî');
        setText('div_taxeDividendes', '‚Äî');
        setText('div_dividendesNets', '‚Äî');
        setText('div_reserves', '‚Äî');
        setText('div_netFinal', '‚Äî');
        setText('div_tauxPonction', '‚Äî');
      }

      // Charts si onglet actif
      const activeTab = document.querySelector('.tab.active');
      if (activeTab && activeTab.textContent.includes('Graphiques')) {
        initCharts();
      }
    }

    function resetDefaults() {
      document.getElementById('resultatAnnuel').value = 30000;
      document.getElementById('valeurOeuvre').value = 30000;
      document.getElementById('loyerMensuel').value = 1600;
      document.getElementById('tauxIS').value = 25;
      document.getElementById('tauxDividendes').value = 30;
      document.getElementById('dureeMois').value = 24;
      document.getElementById('apportInitial').value = 0;
      document.getElementById('tauxDistribution').value = 100;
      document.getElementById('tauxDistributionValue').textContent = '100%';
      updateCalculations();
    }

    function downloadPDF() {
      const originalTitle = document.title;
      document.title = 'Rapport Art Leasing';
      const contents = document.querySelectorAll('.tab-content');
      contents.forEach(c => c.style.display = 'block');
      window.print();
      setTimeout(() => {
        document.title = originalTitle;
        showTab(0);
      }, 100);
    }

    function showTab(index) {
      const tabs = document.querySelectorAll('.tab');
      const contents = document.querySelectorAll('.tab-content');
      tabs.forEach(t => t.classList.remove('active'));
      contents.forEach(c => c.classList.remove('active'));
      tabs[index].classList.add('active');
      contents[index].classList.add('active');
      if (index === 5) setTimeout(() => initCharts(), 100);
    }

    let charts = {};
    function initCharts(){
      const c = calculations;

      function destroyIfExists(id){
        const ctx = document.getElementById(id);
        if (!ctx) return ctx;
        if (ctx.chart){ ctx.chart.destroy(); }
        return ctx;
      }

      // R√©sultat n√©cessaire
      const ctx1 = destroyIfExists('resultatChart');
      if (ctx1){
        ctx1.chart = new Chart(ctx1, {
          type: 'bar',
          data: {
            labels: ['Art Leasing', 'Dividendes'],
            datasets: [{
              label: 'R√©sultat n√©cessaire (‚Ç¨)',
              data: [c.resultatTotal, c.div_resultatNecessaire || 0],
              backgroundColor: ['#4CAF50', '#f44336'],
              borderColor: ['#45a049', '#d32f2f'],
              borderWidth: 2
            }]
          },
          options: {
            responsive: true, maintainAspectRatio: false,
            plugins: { title: { display: true, text: `R√©sultat n√©cessaire pour ${fmtEUR(c.art_netTotal)} nets`, font: { size: 18 } } },
            scales: { y: { beginAtZero: true, ticks: { callback: v => v.toLocaleString() + ' ‚Ç¨' } } }
          }
        });
      }

      // Net obtenu (m√™me r√©sultat)
      const ctx2 = destroyIfExists('netChart');
      if (ctx2){
        ctx2.chart = new Chart(ctx2, {
          type: 'bar',
          data: {
            labels: ['Art Leasing', 'Dividendes'],
            datasets: [{
              label: 'Net dans la poche (‚Ç¨)',
              data: [c.art_netTotal, c.div2_netPoche],
              backgroundColor: ['#4CAF50', '#667eea'],
              borderColor: ['#45a049', '#5568d3'],
              borderWidth: 2
            }]
          },
          options: {
            responsive: true, maintainAspectRatio: false,
            plugins: { title: { display: true, text: `Net obtenu avec ${fmtEUR(c.resultatTotal)} de r√©sultat`, font: { size: 18 } } },
            scales: { y: { beginAtZero: true, ticks: { callback: v => v.toLocaleString() + ' ‚Ç¨' } } }
          }
        });
      }

      // Vision compl√®te
      const ctx3 = destroyIfExists('efficaciteChart');
      if (ctx3){
        ctx3.chart = new Chart(ctx3, {
          type: 'bar',
          data: {
            labels: ['R√©sultat AL', 'Net AL', 'R√©sultat Div (√©quiv.)', 'Net Div (m√™me r√©s.)'],
            datasets: [{
              label: 'Montants (‚Ç¨)',
              data: [c.resultatTotal, c.art_netTotal, c.div_resultatNecessaire || 0, c.div2_netPoche],
              backgroundColor: ['#4CAF50', '#84fab0', '#f44336', '#667eea'],
              borderWidth: 2
            }]
          },
          options: {
            responsive: true, maintainAspectRatio: false,
            plugins: { title: { display: true, text: 'Vision compl√®te des deux comparaisons', font: { size: 18 } } },
            scales: { y: { beginAtZero: true, ticks: { callback: v => v.toLocaleString() + ' ‚Ç¨' } } }
          }
        });
      }

      // Co√ªt d‚Äôextraction (info)
      const ctx4 = destroyIfExists('coutChart');
      if (ctx4){
        ctx4.chart = new Chart(ctx4, {
          type: 'bar',
          data: {
            labels: ['Art Leasing', 'Dividendes'],
            datasets: [{
              label: 'Co√ªt total extraction (‚Ç¨)',
              data: [c.extract_AL_coutTotal, c.extract_div_coutTotal],
              backgroundColor: ['rgba(255, 152, 0, 0.7)', 'rgba(244, 67, 54, 0.7)'],
              borderColor: ['#ff9800', '#f44336'],
              borderWidth: 2
            },{
              label: 'Valeur nette extraite (‚Ç¨)',
              data: [c.valeur_extraite, c.valeur_extraite],
              backgroundColor: ['rgba(76, 175, 80, 0.7)', 'rgba(76, 175, 80, 0.7)'],
              borderColor: ['#4CAF50', '#4CAF50'],
              borderWidth: 2
            }]
          },
          options: {
            responsive: true, maintainAspectRatio: false,
            plugins: { title: { display: true, text: `Extraction de ${fmtEUR(c.valeur_extraite)} : Co√ªt compar√©`, font: { size: 18 } } },
            scales: { y: { beginAtZero: true, ticks: { callback: v => v.toLocaleString() + ' ‚Ç¨' } } }
          }
        });
      }
    }

    window.onload = resetDefaults;
  </script>
</body>
</html>
